# Changelog: –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –≠—Ç–∞–ø–æ–≤ 1‚Äì6

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### –≠—Ç–∞–ø 1 ‚Äî –ö–æ–Ω—Ç—Ä–∞–∫—Ç OrchestratorResult
- –î–æ–±–∞–≤–ª–µ–Ω—ã docstring –¥–ª—è `OrchestratorResult` –∏ `ensure_valid()` –≤ `app/core/result.py`.
- –î–æ–±–∞–≤–ª–µ–Ω—ã 8 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤ `tests/test_result_contract.py`: –ø—É—Å—Ç–æ–π text ‚Üí –∑–∞–≥–ª—É—à–∫–∞, refused —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è actions, —Ä–µ–∂–∏–º—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç, intent —Å/–±–µ–∑ —Ç–æ—á–∫–∏, sources, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞.
- –ü—É–±–ª–∏—á–Ω—ã–π API –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–µ –∏–∑–º–µ–Ω—è–ª–∏—Å—å.

### –≠—Ç–∞–ø 2 ‚Äî Wizard –∏ –º–µ–Ω—é
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –µ–¥–∏–Ω—ã–π —à–∞–≥ ¬´‚¨ÖÔ∏è –ù–∞–∑–∞–¥¬ª (`wizard_back`) –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ calendar.add, reminder.create, reminder.reschedule: –∫–Ω–æ–ø–∫–∞ –Ω–∞ —à–∞–≥–∞—Ö —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∞–≥–æ–º, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞–∑–∞–¥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤–≤–µ–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- –¢–∞–π–º–∞—É—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è —É–∂–µ –±—ã–ª (WizardStore): –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ¬´–°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å—Ç—ë–∫. –ù–∞—á–Ω–∏ –∑–∞–Ω–æ–≤–æ –∏–∑ –º–µ–Ω—é.¬ª —Å –∫–Ω–æ–ø–∫–æ–π ¬´üè† –ú–µ–Ω—é¬ª.
- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: –æ—Ç–≤–µ—Ç refused —Å –∫–Ω–æ–ø–∫–æ–π ¬´üè† –ú–µ–Ω—é¬ª; –≤ `tests/test_contract_regressions.py` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã: `test_wizard_back_calendar_add_happy_path`, `test_wizard_back_reminder_create_happy_path` –≤ `tests/test_wizard_ux.py`.

### –≠—Ç–∞–ø 3 ‚Äî –ü–æ–∏—Å–∫ –∏ —Å—Ç—Ä–æ–≥–∏–µ —Ñ–∞–∫—Ç—ã
- –í `app/core/facts.py`: –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ URL –≤ `format_sources_block` –∏ `build_sources_prompt` (–µ–¥–∏–Ω—ã–π –±–ª–æ–∫ ¬´–ò—Å—Ç–æ—á–Ω–∏–∫–∏:¬ª, –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤).
- –í `tests/test_pseudo_sources.py`: —Ç–µ—Å—Ç `test_strict_guard_refuses_text_with_citation_but_no_sources` (–æ—Ç–≤–µ—Ç —Å [1] –±–µ–∑ sources ‚Üí refused —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π /search).
- –í `tests/test_facts_render.py`: —Ç–µ—Å—Ç `test_format_sources_block_dedupes_by_url`.
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ `/search` –∏ strict facts —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ.

### –≠—Ç–∞–ø 4 ‚Äî –ö–∞–ª–µ–Ω–¥–∞—Ä—å
- –í `tests/test_calendar_parse.py`: —Ç–µ—Å—Ç—ã –Ω–∞ ¬´–≤ 9¬ª = 09:00, –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ timezone (BOT_TZ), ¬´–ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞¬ª.
- –í `tests/test_recurrence_series.py`: —Ç–µ—Å—Ç `test_delete_instance_this_adds_exdate_keeps_series` (—É–¥–∞–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ RRULE).
- –í `app/core/tools_calendar_caldav.py`: —Ä–µ—Ç—Ä–∞–∏ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫) –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å `correlation_id` –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö create_event.

### –≠—Ç–∞–ø 5 ‚Äî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –¥–∞–π–¥–∂–µ—Å—Ç
- –î–æ–±–∞–≤–ª–µ–Ω –º–æ–¥—É–ª—å `app/core/digest.py` —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `build_daily_digest_text(events, reminders, for_date, tz, ...)`: —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –¥–∞–π–¥–∂–µ—Å—Ç–∞ –Ω–∞ –¥–∞—Ç—É; –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–æ–±—ã—Ç–∏–π –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É (–Ω–µ —Å–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ).
- –¢–µ—Å—Ç—ã –≤ `tests/test_digest.py`: –ø—É—Å—Ç–æ–π –¥–∞–π–¥–∂–µ—Å—Ç, —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è, —Ç–æ–ª—å–∫–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ max_events.

### –≠—Ç–∞–ø 6 ‚Äî –ü–∞–º—è—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –í `tests/test_user_profile_store.py`: —Ç–µ—Å—Ç `test_profile_store_corrupted_json_returns_safe_defaults` ‚Äî –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π JSON –≤ –ø—Ä–æ—Ñ–∏–ª–µ –Ω–µ –ª–æ–º–∞–µ—Ç `get()`, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è defaults.
- –ö–æ–º–∞–Ω–¥—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —É–∂–µ –µ—Å—Ç—å: `/context_on`, `/context_off`, `/context_clear` (–æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞).

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –í `README.md` –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è **¬´–ö–æ–º–∞–Ω–¥—ã –∏ —Ä–µ–∂–∏–º—ã¬ª**: /menu, /search, /facts_on/off, /context_on/off/clear, /profile, /reminders, DRY_RUN.
- –û–ø–∏—Å–∞–Ω —Ä–µ–∂–∏–º **DRY_RUN** (–ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ Telegram, BOT_TOKEN –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω).
- –ö—Ä–∞—Ç–∫–æ —É–ø–æ–º—è–Ω—É—Ç –¥–∞–π–¥–∂–µ—Å—Ç –¥–Ω—è –≤ —Ä–∞–∑–¥–µ–ª–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π.

## –ß—Ç–æ –Ω–µ –º–µ–Ω—è–ª–æ—Å—å
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: –ø—É–±–ª–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∫–Ω–æ–ø–∫–∏, –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã API —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.
- Google Calendar –Ω–µ –¥–æ–±–∞–≤–ª—è–ª—Å—è (–≤ –∫–æ–¥–µ –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π).
- DRY_RUN —Ä–µ–∂–∏–º –Ω–µ –º–µ–Ω—è–ª—Å—è.

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
```bash
python -m venv .venv && .venv/bin/pip install -r requirements.txt
.venv/bin/pytest
```
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ. –ó–∞–ø—É—Å–∫ –≤ DRY_RUN: –∑–∞–¥–∞—Ç—å `DRY_RUN=1` –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å `python bot.py` (–±–µ–∑ BOT_TOKEN).
